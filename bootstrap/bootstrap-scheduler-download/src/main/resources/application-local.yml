# ===============================================
# Local Profile Configuration - Download Scheduler
# ===============================================
# 로컬 개발 환경 전용 설정
#
# @author FileFlow Team
# @since 1.0.0
# ===============================================

spring:
  # ===============================================
  # DataSource Configuration (Local)
  # ===============================================
  datasource:
    url: jdbc:mysql://localhost:3307/fileflow?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
    username: fileflow_user
    password: fileflow_password
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 10  # 로컬은 적은 커넥션
      minimum-idle: 3
      pool-name: DownloadScheduler-Local-HikariPool

  # ===============================================
  # Redis Configuration (Local)
  # ===============================================
  data:
    redis:
      host: localhost
      port: 6380
      password: ""
      timeout: 3000ms

  # ===============================================
  # Flyway Configuration (Local)
  # ===============================================
  flyway:
    enabled: false  # Scheduler는 Flyway 비활성화 (web-api에서만 실행)

# ===============================================
# AWS S3 Configuration (Local - MinIO)
# ===============================================
aws:
  s3:
    region: ap-northeast-2
    bucket: fileflow-local
    # MinIO 로컬 자격증명
    access-key: minioadmin
    secret-key: minioadmin
    endpoint: http://localhost:9000

  # CloudWatch Logs (Local)
  cloudwatch:
    region: ap-northeast-2
    log-group: /local/fileflow-scheduler-download
    log-stream: download-scheduler-local

# ===============================================
# Download Scheduler Configuration (Local)
# ===============================================
fileflow:
  download:
    outbox:
      fixed-delay: 10000  # 10초 (로컬은 빠른 주기)
      initial-delay: 5000
      batch-size: 5  # 로컬은 작은 배치
      max-retry-count: 2
      retry-base-delay-seconds: 30
      retry-multiplier: 2.0
      retry-max-delay-seconds: 600
      stale-minutes: 3

# ===============================================
# Actuator Configuration (Local)
# ===============================================
management:
  server:
    port: 9091
  endpoints:
    web:
      exposure:
        include: "*"  # 로컬에서는 모든 엔드포인트 노출
  endpoint:
    health:
      show-details: always

# ===============================================
# Logging Configuration (Local)
# ===============================================
logging:
  level:
    root: DEBUG
    com.ryuqq.fileflow: TRACE
    org.springframework: INFO
    org.springframework.scheduling: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
