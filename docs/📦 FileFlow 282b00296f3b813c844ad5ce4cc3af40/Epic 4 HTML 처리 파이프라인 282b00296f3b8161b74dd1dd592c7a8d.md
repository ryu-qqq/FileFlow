# Epic 4: HTML ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

## ğŸ¯ ê°œìš”

ìƒí’ˆ ìƒì„¸ HTMLì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì´ë¯¸ì§€ ìµœì í™”, í…ìŠ¤íŠ¸ ì¶”ì¶œ, CDN ë°°í¬ë¥¼ ìë™í™”í•©ë‹ˆë‹¤.

**ëª©í‘œ**: ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ ì„±ëŠ¥ ê°œì„  ë° ê²€ìƒ‰ ì •í™•ë„ í–¥ìƒ

**ì˜ˆìƒ ì‹œê°„**: 40ì‹œê°„ (1ì£¼)

**ìš°ì„ ìˆœìœ„**: P3

---

## ğŸ”‘ í•µì‹¬ ê¸°ëŠ¥

### 1. HTML íŒŒì‹±

- Jsoup ê¸°ë°˜ HTML íŒŒì‹±
- ì´ë¯¸ì§€ íƒœê·¸ ì¶”ì¶œ (`<img>` íƒœê·¸)
- í…ìŠ¤íŠ¸ ì¶”ì¶œ ë° ì •ì œ
- ë©”íƒ€ë°ì´í„° ì¶”ì¶œ

### 2. ì™¸ë¶€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ

- HTML ë‚´ ì™¸ë¶€ ì´ë¯¸ì§€ URL ì‹ë³„
- HTTP ê¸°ë°˜ ë³‘ë ¬ ë‹¤ìš´ë¡œë“œ
- S3 ì—…ë¡œë“œ
- ì¬ì‹œë„ ë¡œì§ (ìµœëŒ€ 3íšŒ)

### 3. ì´ë¯¸ì§€ ìµœì í™”

- Epic 3 ì´ë¯¸ì§€ íŒŒì´í”„ë¼ì¸ ì¬ì‚¬ìš©
- WebP ë³€í™˜
- ì••ì¶• (í’ˆì§ˆ 90%)
- ì¸ë„¤ì¼ ìƒì„±

### 4. HTML ì¬ìƒì„±

- ì´ë¯¸ì§€ URLì„ S3 URLë¡œ ì¹˜í™˜
- HTML ì •ì œ (sanitization)
- ìµœì í™”ëœ HTML ìƒì„±

### 5. CDN ë°°í¬

- CloudFront ìë™ ë°°í¬
- ìºì‹œ ë¬´íš¨í™”

---

## ğŸ“Š ì²˜ë¦¬ í”Œë¡œìš°

```
[ì›ë³¸ HTML ì…ë ¥]
    â†“
[1. HTML íŒŒì‹±]
    â”œâ”€ ì´ë¯¸ì§€ URL ì¶”ì¶œ
    â”œâ”€ í…ìŠ¤íŠ¸ ì¶”ì¶œ
    â””â”€ êµ¬ì¡° ë¶„ì„
    â†“
[2. ì™¸ë¶€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ]
    â”œâ”€ URLë³„ ë³‘ë ¬ ë‹¤ìš´ë¡œë“œ
    â”œâ”€ S3 ì—…ë¡œë“œ
    â””â”€ URL ë§¤í•‘ ìƒì„±
    â†“
[3. ì´ë¯¸ì§€ ìµœì í™”] (Epic 3 ì¬ì‚¬ìš©)
    â”œâ”€ WebP ë³€í™˜
    â”œâ”€ ì••ì¶•
    â”œâ”€ ì¸ë„¤ì¼ ìƒì„±
    â””â”€ CDN URL ìƒì„±
    â†“
[4. HTML ì¬ìƒì„±]
    â”œâ”€ ì´ë¯¸ì§€ URL ì¹˜í™˜
    â”œâ”€ HTML ì •ì œ
    â””â”€ ìµœì í™”ëœ HTML ìƒì„±
    â†“
[5. CDN ë°°í¬]
    â””â”€ CloudFront ë°°í¬
    â†“
[ìµœì í™”ëœ HTML ì™„ë£Œ]
```

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„

### Hexagonal Architecture ì ìš©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Interface Layer                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  HtmlProcessingController     â”‚     â”‚
â”‚  â”‚  - POST /api/v1/html/parse    â”‚     â”‚
â”‚  â”‚  - POST /api/v1/html/process  â”‚     â”‚
â”‚  â”‚  - GET /api/v1/html/{id}      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Application Layer                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  ParseHtmlUseCase             â”‚     â”‚
â”‚  â”‚  DownloadExternalImagesUseCaseâ”‚     â”‚
â”‚  â”‚  OptimizeHtmlImagesUseCase    â”‚     â”‚
â”‚  â”‚  GenerateOptimizedHtmlUseCase â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Domain Layer                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  HtmlContent (Entity)         â”‚     â”‚
â”‚  â”‚  HtmlImage (Entity)           â”‚     â”‚
â”‚  â”‚  ProcessedHtml (Entity)       â”‚     â”‚
â”‚  â”‚                               â”‚     â”‚
â”‚  â”‚  HtmlParserPort               â”‚     â”‚
â”‚  â”‚  ImageDownloaderPort          â”‚     â”‚
â”‚  â”‚  HtmlGeneratorPort            â”‚     â”‚
â”‚  â”‚  HtmlStoragePort              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Infrastructure Layer               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  JsoupHtmlParserAdapter       â”‚     â”‚
â”‚  â”‚  HttpImageDownloaderAdapter   â”‚     â”‚
â”‚  â”‚  S3HtmlStorageAdapter         â”‚     â”‚
â”‚  â”‚  MySQLHtmlRepository          â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Domain ëª¨ë¸

### 1. HtmlContent (Entity)

```java
public class HtmlContent {
    private final HtmlContentId id;
    private final String rawHtml;
    private final List<HtmlImage> images;
    private final String extractedText;
    private final ProcessingStatus status;
    private final Instant createdAt;
    
    public static HtmlContent create(
        String rawHtml,
        List<HtmlImage> images,
        String extractedText
    ) {
        return new HtmlContent(
            HtmlContentId.generate(),
            rawHtml,
            images,
            extractedText,
            ProcessingStatus.PENDING,
            [Instant.now](http://Instant.now)()
        );
    }
}
```

### 2. HtmlImage (Entity)

```java
public class HtmlImage {
    private final HtmlImageId id;
    private final String originalUrl;
    private final String optimizedUrl;
    private final ImageMetadata metadata;
    private final ProcessingStatus status;
    
    public static HtmlImage create(
        String originalUrl,
        String altText,
        String width,
        String height
    ) {
        return new HtmlImage(
            HtmlImageId.generate(),
            originalUrl,
            null,
            ImageMetadata.of(altText, width, height),
            ProcessingStatus.PENDING
        );
    }
}
```

### 3. ProcessedHtml (Entity)

```java
public class ProcessedHtml {
    private final ProcessedHtmlId id;
    private final HtmlContentId htmlContentId;
    private final String optimizedHtml;
    private final String cdnUrl;
    private final ProcessingMetadata metadata;
    private final Instant processedAt;
    
    public static ProcessedHtml create(
        HtmlContentId contentId,
        String optimizedHtml,
        HtmlMetrics metrics
    ) {
        return new ProcessedHtml(
            ProcessedHtmlId.generate(),
            contentId,
            optimizedHtml,
            null,
            ProcessingMetadata.of(metrics),
            [Instant.now](http://Instant.now)()
        );
    }
}
```

---

## ğŸ”Œ Port ì¸í„°í˜ì´ìŠ¤

### 1. HtmlParserPort

```java
public interface HtmlParserPort {
    ParsedHtml parse(String rawHtml);
    List<HtmlImage> extractImages(String html);
    String extractText(String html);
}
```

### 2. ImageDownloaderPort

```java
public interface ImageDownloaderPort {
    DownloadedImage download(String imageUrl);
    List<DownloadedImage> downloadBatch(List<String> imageUrls);
}
```

### 3. HtmlGeneratorPort

```java
public interface HtmlGeneratorPort {
    String replaceImageUrls(String html, Map<String, String> urlMapping);
    String sanitize(String html);
    String optimize(String html);
}
```

### 4. HtmlStoragePort

```java
public interface HtmlStoragePort {
    void save(HtmlContent content);
    Optional<HtmlContent> findById(HtmlContentId id);
    void saveProcessed(ProcessedHtml processed);
    Optional<ProcessedHtml> findProcessedById(ProcessedHtmlId id);
}
```

---

## ğŸ¬ UseCase êµ¬í˜„

### 1. ParseHtmlUseCase

```java
public class ParseHtmlUseCase {
    private final HtmlParserPort htmlParser;
    private final HtmlStoragePort htmlStorage;
    
    public ParsedHtmlResult execute(ParseHtmlCommand command) {
        // 1. HTML íŒŒì‹±
        ParsedHtml parsed = htmlParser.parse(command.rawHtml());
        
        // 2. ì´ë¯¸ì§€ ì¶”ì¶œ
        List<HtmlImage> images = htmlParser.extractImages(command.rawHtml());
        
        // 3. í…ìŠ¤íŠ¸ ì¶”ì¶œ
        String text = htmlParser.extractText(command.rawHtml());
        
        // 4. HtmlContent ìƒì„±
        HtmlContent content = HtmlContent.create(
            command.rawHtml(),
            images,
            text
        );
        
        // 5. ì €ì¥
        [htmlStorage.save](http://htmlStorage.save)(content);
        
        return new ParsedHtmlResult(
            content.getId(),
            images.size(),
            text.length(),
            ProcessingStatus.COMPLETED
        );
    }
}
```

### 2. DownloadExternalImagesUseCase

```java
public class DownloadExternalImagesUseCase {
    private final ImageDownloaderPort downloader;
    private final FileUploadPort fileUpload;
    
    public DownloadedImagesResult execute(DownloadImagesCommand command) {
        Map<String, String> urlMapping = new HashMap<>();
        
        for (String url : command.imageUrls()) {
            try {
                // 1. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                DownloadedImage image = [downloader.download](http://downloader.download)(url);
                
                // 2. S3 ì—…ë¡œë“œ
                String s3Url = fileUpload.upload(image);
                
                // 3. URL ë§¤í•‘ ì €ì¥
                urlMapping.put(url, s3Url);
                
            } catch (Exception e) {
                // ì—ëŸ¬ ì²˜ë¦¬
            }
        }
        
        return new DownloadedImagesResult(
            urlMapping,
            urlMapping.size(),
            0
        );
    }
}
```

### 3. OptimizeHtmlImagesUseCase

```java
public class OptimizeHtmlImagesUseCase {
    private final ImageProcessingPort imageProcessor;  // Epic 3
    
    public OptimizedImagesResult execute(OptimizeImagesCommand command) {
        // Epic 3 ì´ë¯¸ì§€ íŒŒì´í”„ë¼ì¸ í˜¸ì¶œ
        Map<String, OptimizedImageUrls> urlMapping = new HashMap<>();
        
        for (HtmlImage image : images) {
            OptimizedImage optimized = imageProcessor.process(
                image.getOptimizedUrl(),
                command.options()
            );
            
            urlMapping.put(
                image.getOriginalUrl(),
                new OptimizedImageUrls(
                    optimized.getOptimizedUrl(),
                    optimized.getThumbnailUrl(),
                    optimized.getCdnUrl()
                )
            );
        }
        
        return new OptimizedImagesResult(urlMapping, urlMapping.size(), 0);
    }
}
```

### 4. GenerateOptimizedHtmlUseCase

```java
public class GenerateOptimizedHtmlUseCase {
    private final HtmlGeneratorPort htmlGenerator;
    private final HtmlStoragePort htmlStorage;
    private final CdnPort cdnPort;
    
    public OptimizedHtmlResult execute(GenerateOptimizedHtmlCommand command) {
        // 1. ì›ë³¸ HTML ë¡œë“œ
        HtmlContent content = htmlStorage.findById(command.contentId())
            .orElseThrow();
        
        // 2. ì´ë¯¸ì§€ URL ì¹˜í™˜
        String replacedHtml = htmlGenerator.replaceImageUrls(
            content.getRawHtml(),
            command.imageUrlMapping()
        );
        
        // 3. HTML ì •ì œ ë° ìµœì í™”
        String optimized = htmlGenerator.optimize(
            htmlGenerator.sanitize(replacedHtml)
        );
        
        // 4. ProcessedHtml ìƒì„± ë° ì €ì¥
        ProcessedHtml processed = ProcessedHtml.create(
            command.contentId(),
            optimized,
            calculateMetrics(content.getRawHtml(), optimized)
        );
        
        htmlStorage.saveProcessed(processed);
        
        // 5. CDN ë°°í¬
        String cdnUrl = cdnPort.deploy(processed);
        
        return new OptimizedHtmlResult(
            processed.getId(),
            optimized,
            cdnUrl,
            processed.getMetadata().getMetrics()
        );
    }
}
```

---

## ğŸ”§ Adapter êµ¬í˜„

### 1. JsoupHtmlParserAdapter

```java
public class JsoupHtmlParserAdapter implements HtmlParserPort {
    
    @Override
    public ParsedHtml parse(String rawHtml) {
        Document doc = Jsoup.parse(rawHtml);
        return new ParsedHtml(
            doc.title(),
            doc.body().html(),
            extractMetadata(doc)
        );
    }
    
    @Override
    public List<HtmlImage> extractImages(String html) {
        Document doc = Jsoup.parse(html);
        Elements imgElements = [doc.select](http://doc.select)("img");
        
        return [imgElements.stream](http://imgElements.stream)()
            .map(this::convertToHtmlImage)
            .collect(Collectors.toList());
    }
    
    @Override
    public String extractText(String html) {
        Document doc = Jsoup.parse(html);
        return doc.body().text();
    }
}
```

### 2. HttpImageDownloaderAdapter

```java
public class HttpImageDownloaderAdapter implements ImageDownloaderPort {
    private final HttpClient httpClient;
    
    @Override
    public DownloadedImage download(String imageUrl) {
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(imageUrl))
            .timeout(Duration.ofSeconds(30))
            .GET()
            .build();
        
        HttpResponse<byte[]> response = httpClient.send(
            request,
            HttpResponse.BodyHandlers.ofByteArray()
        );
        
        return DownloadedImage.create(
            imageUrl,
            response.body(),
            extractContentType(response),
            response.body().length
        );
    }
    
    @Override
    public List<DownloadedImage> downloadBatch(List<String> imageUrls) {
        return imageUrls.parallelStream()
            .map(this::download)
            .collect(Collectors.toList());
    }
}
```

### 3. S3HtmlStorageAdapter

```java
public class S3HtmlStorageAdapter implements HtmlStoragePort {
    private final S3Client s3Client;
    private final String bucketName;
    
    @Override
    public void save(HtmlContent content) {
        String key = buildKey(content.getId());
        
        PutObjectRequest request = PutObjectRequest.builder()
            .bucket(bucketName)
            .key(key)
            .contentType("text/html; charset=UTF-8")
            .build();
        
        s3Client.putObject(
            request,
            RequestBody.fromString(content.getRawHtml())
        );
    }
    
    @Override
    public void saveProcessed(ProcessedHtml processed) {
        String key = buildProcessedKey(processed.getId());
        
        s3Client.putObject(
            PutObjectRequest.builder()
                .bucket(bucketName)
                .key(key)
                .contentType("text/html; charset=UTF-8")
                .build(),
            RequestBody.fromString(processed.getOptimizedHtml())
        );
    }
}
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 1. html_content

```sql
CREATE TABLE html_content (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    content_id VARCHAR(36) NOT NULL UNIQUE,
    raw_html LONGTEXT NOT NULL,
    extracted_text TEXT,
    source_url VARCHAR(2048),
    status VARCHAR(20) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_content_id (content_id),
    INDEX idx_status (status),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 2. html_image

```sql
CREATE TABLE html_image (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    image_id VARCHAR(36) NOT NULL UNIQUE,
    content_id VARCHAR(36) NOT NULL,
    original_url VARCHAR(2048) NOT NULL,
    optimized_url VARCHAR(2048),
    cdn_url VARCHAR(2048),
    alt_text VARCHAR(255),
    width INT,
    height INT,
    status VARCHAR(20) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_image_id (image_id),
    INDEX idx_content_id (content_id),
    FOREIGN KEY (content_id) REFERENCES html_content(content_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 3. processed_html

```sql
CREATE TABLE processed_html (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    processed_id VARCHAR(36) NOT NULL UNIQUE,
    content_id VARCHAR(36) NOT NULL,
    optimized_html LONGTEXT NOT NULL,
    cdn_url VARCHAR(2048),
    original_size INT NOT NULL,
    optimized_size INT NOT NULL,
    compression_ratio DECIMAL(5,2),
    image_count INT NOT NULL,
    processed_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_processed_id (processed_id),
    INDEX idx_content_id (content_id),
    FOREIGN KEY (content_id) REFERENCES html_content(content_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## ğŸŒ API ì—”ë“œí¬ì¸íŠ¸

### 1. HTML íŒŒì‹± API

```
POST /api/v1/html/parse
Content-Type: application/json

{
  "rawHtml": "<html>...</html>",
  "sourceUrl": "[https://example.com/product/123](https://example.com/product/123)"
}

Response:
{
  "contentId": "550e8400-e29b-41d4-a716-446655440000",
  "imageCount": 15,
  "textLength": 2048,
  "status": "COMPLETED"
}
```

### 2. HTML ì „ì²´ ì²˜ë¦¬ API

```
POST /api/v1/html/process
Content-Type: application/json

{
  "rawHtml": "<html>...</html>",
  "sourceUrl": "[https://example.com/product/123](https://example.com/product/123)",
  "options": {
    "downloadExternalImages": true,
    "optimizeImages": true,
    "deployCdn": true
  }
}

Response:
{
  "processedId": "660f9511-f3ac-52e5-b827-557766551111",
  "cdnUrl": "[https://cdn.example.com/processed/660f9511.html](https://cdn.example.com/processed/660f9511.html)",
  "metrics": {
    "originalSize": 524288,
    "optimizedSize": 245760,
    "compressionRatio": 46.9,
    "imageCount": 15
  }
}
```

### 3. ì²˜ë¦¬ ìƒíƒœ ì¡°íšŒ API

```
GET /api/v1/html/{contentId}/status

Response:
{
  "contentId": "550e8400-e29b-41d4-a716-446655440000",
  "status": "PROCESSING",
  "imageCount": 15,
  "progress": 60
}
```

### 4. ì²˜ë¦¬ëœ HTML ì¡°íšŒ API

```
GET /api/v1/html/processed/{processedId}

Response:
{
  "processedId": "660f9511-f3ac-52e5-b827-557766551111",
  "optimizedHtml": "<html>...</html>",
  "cdnUrl": "[https://cdn.example.com/processed/660f9511.html](https://cdn.example.com/processed/660f9511.html)",
  "metadata": {
    "originalSize": 524288,
    "optimizedSize": 245760,
    "processedAt": "2025-10-04T14:30:00Z"
  }
}
```

---

## ğŸ“ S3 ì €ì¥ì†Œ êµ¬ì¡°

```
s3://fileflow-prod/
â””â”€â”€ b2c/
    â””â”€â”€ product/
        â””â”€â”€ {userId}/
            â””â”€â”€ {productId}/
                â””â”€â”€ html/
                    â”œâ”€â”€ original/
                    â”‚   â””â”€â”€ detail.html
                    â”œâ”€â”€ processed/
                    â”‚   â””â”€â”€ detail_optimized.html
                    â””â”€â”€ images/
                        â”œâ”€â”€ original/
                        â”‚   â”œâ”€â”€ extracted_1.jpg
                        â”‚   â””â”€â”€ extracted_2.jpg
                        â””â”€â”€ optimized/
                            â”œâ”€â”€ extracted_1.webp
                            â””â”€â”€ extracted_2.webp
```

---

## âœ… ì‘ì—… ë¶„í•´ (Tasks)

### KAN-52: HTML ì²˜ë¦¬ Domain ëª¨ë¸ êµ¬í˜„ (4ì‹œê°„)

- HtmlContent, HtmlImage, ProcessedHtml ì—”í‹°í‹°
- Value Objects (HtmlContentId, ImageMetadata ë“±)
- ProcessingStatus Enum

### KAN-53: HTML ì²˜ë¦¬ Port ì¸í„°í˜ì´ìŠ¤ ì •ì˜ (3ì‹œê°„)

- HtmlParserPort
- ImageDownloaderPort
- HtmlGeneratorPort
- HtmlStoragePort
- HtmlImageStoragePort

### KAN-54: HTML íŒŒì‹± UseCase êµ¬í˜„ (5ì‹œê°„)

- ParseHtmlUseCase
- HTML íŒŒì‹± ë° ì´ë¯¸ì§€ ì¶”ì¶œ
- í…ìŠ¤íŠ¸ ì¶”ì¶œ

### KAN-55: ì™¸ë¶€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ UseCase êµ¬í˜„ (6ì‹œê°„)

- DownloadExternalImagesUseCase
- ë³‘ë ¬ ë‹¤ìš´ë¡œë“œ
- ì¬ì‹œë„ ë¡œì§

### KAN-56: HTML ì´ë¯¸ì§€ ìµœì í™” UseCase êµ¬í˜„ (5ì‹œê°„)

- OptimizeHtmlImagesUseCase
- Epic 3 íŒŒì´í”„ë¼ì¸ ì—°ë™

### KAN-57: ìµœì í™”ëœ HTML ìƒì„± UseCase êµ¬í˜„ (6ì‹œê°„)

- GenerateOptimizedHtmlUseCase
- URL ì¹˜í™˜
- HTML ì •ì œ ë° ìµœì í™”

### KAN-58: Jsoup HTML íŒŒì„œ Adapter êµ¬í˜„ (4ì‹œê°„)

- JsoupHtmlParserAdapter
- HTML íŒŒì‹±
- ì´ë¯¸ì§€ ì¶”ì¶œ

### KAN-59: HTTP ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë” Adapter êµ¬í˜„ (5ì‹œê°„)

- HttpImageDownloaderAdapter
- ë³‘ë ¬ ë‹¤ìš´ë¡œë“œ
- íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬

### KAN-60: S3 HTML ì €ì¥ì†Œ Adapter êµ¬í˜„ (4ì‹œê°„)

- S3HtmlStorageAdapter
- HTML ì €ì¥/ì¡°íšŒ

### KAN-61: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° êµ¬í˜„ (5ì‹œê°„)

- html_content í…Œì´ë¸”
- html_image í…Œì´ë¸”
- processed_html í…Œì´ë¸”

### KAN-62: HTML ì²˜ë¦¬ API Controller êµ¬í˜„ (5ì‹œê°„)

- REST API ì—”ë“œí¬ì¸íŠ¸
- Request/Response DTO
- ì…ë ¥ ê²€ì¦

### KAN-63: í†µí•© í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œí™” (6ì‹œê°„)

- End-to-End í…ŒìŠ¤íŠ¸
- API ë¬¸ì„œí™”
- README ì—…ë°ì´íŠ¸

---

## ğŸ”— ê´€ë ¨ ë§í¬

- **Jira Epic**: [KAN-51](https://ryuqqq.atlassian.net/browse/KAN-51)
- **GitHub**: [https://github.com/ryu-qqq/FileFlow](https://github.com/ryu-qqq/FileFlow)
- **Epic 3 (ì´ë¯¸ì§€ ì²˜ë¦¬)**: ì´ë¯¸ì§€ ìµœì í™” íŒŒì´í”„ë¼ì¸ ì¬ì‚¬ìš©
- **ìƒìœ„ í”„ë¡œì íŠ¸**: ğŸ—ï¸ Setof ê³ ë„í™” í”„ë¡œì íŠ¸

---

## ğŸ’¡ ê¸°ìˆ ì  ê³ ë ¤ì‚¬í•­

### 1. HTML íŒŒì‹±

- Jsoup ì‚¬ìš© (ì•ˆì •ì„±, ì„±ëŠ¥)
- ì˜ëª»ëœ HTML ì²˜ë¦¬ (ìë™ ë³µêµ¬)
- XSS ë°©ì§€ (sanitization)

### 2. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ

- ë³‘ë ¬ ì²˜ë¦¬ (ìµœëŒ€ 10ê°œ ë™ì‹œ)
- íƒ€ì„ì•„ì›ƒ ì„¤ì • (30ì´ˆ)
- ì¬ì‹œë„ ë¡œì§ (ìµœëŒ€ 3íšŒ)
- ì‹¤íŒ¨í•œ ì´ë¯¸ì§€ëŠ” ê±´ë„ˆë›°ê¸° ì˜µì…˜

### 3. Epic 3 ì—°ë™

- ImageProcessingPort ì¸í„°í˜ì´ìŠ¤ ì¬ì‚¬ìš©
- ë™ì¼í•œ ìµœì í™” íŒŒì´í”„ë¼ì¸ ì ìš©
- ì¼ê´€ëœ ì´ë¯¸ì§€ í’ˆì§ˆ ìœ ì§€

### 4. ì„±ëŠ¥ ìµœì í™”

- ë³‘ë ¬ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
- S3 ë©€í‹°íŒŒíŠ¸ ì—…ë¡œë“œ
- CloudFront ìºì‹±

### 5. ì—ëŸ¬ ì²˜ë¦¬

- ë‹¨ê³„ë³„ ì—ëŸ¬ í•¸ë“¤ë§
- ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©
- ìƒì„¸í•œ ì—ëŸ¬ ë¡œê·¸

---

## ğŸ¯ ì™„ë£Œ ê¸°ì¤€

- [ ]  ëª¨ë“  Domain ëª¨ë¸ êµ¬í˜„ ì™„ë£Œ
- [ ]  ëª¨ë“  Port ì¸í„°í˜ì´ìŠ¤ ì •ì˜ ì™„ë£Œ
- [ ]  ëª¨ë“  UseCase êµ¬í˜„ ì™„ë£Œ
- [ ]  ëª¨ë“  Adapter êµ¬í˜„ ì™„ë£Œ
- [ ]  ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ êµ¬í˜„ ì™„ë£Œ
- [ ]  API Controller êµ¬í˜„ ì™„ë£Œ
- [ ]  ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± ì™„ë£Œ
- [ ]  í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„± ì™„ë£Œ
- [ ]  API ë¬¸ì„œí™” ì™„ë£Œ
- [ ]  Epic 3 ì—°ë™ í…ŒìŠ¤íŠ¸ ì™„ë£Œ

---

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

### ì„±ëŠ¥ ê°œì„ 

- HTML í¬ê¸° ê°ì†Œ: í‰ê·  50%
- ì´ë¯¸ì§€ ìµœì í™”: WebP ë³€í™˜ìœ¼ë¡œ 70% í¬ê¸° ê°ì†Œ
- í˜ì´ì§€ ë¡œë”© ì†ë„: 2~3ë°° ê°œì„ 

### ê²€ìƒ‰ ì •í™•ë„ í–¥ìƒ

- í…ìŠ¤íŠ¸ ì¶”ì¶œë¡œ ìƒí’ˆ ì •ë³´ ê²€ìƒ‰ ê°€ëŠ¥
- ë©”íƒ€ë°ì´í„° ìë™ ìƒì„±

### ìš´ì˜ íš¨ìœ¨ì„±

- ìë™í™”ëœ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
- ì¼ê´€ëœ í’ˆì§ˆ ìœ ì§€
- ìˆ˜ì‘ì—… ì œê±°